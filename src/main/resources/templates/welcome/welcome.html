<!DOCTYPE html>
<!--suppress ThymeleafVariablesResolveInspection -->
<html class="x-admin-sm" xmlns:th="http://www.thymeleaf.org" lang="zh">
<head>
	<meta charset="UTF-8">
	<title>一卡通</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8"/>
	<link rel="stylesheet" href="/x-admin/css/font.css">
	<link rel="stylesheet" href="/x-admin/css/xadmin.css">
	<link rel="stylesheet" href="/x-admin/lib/layui/css/modules/layer/default/layer.css">
</head>
<body>
<div class="x-nav">
            <span class="layui-breadcrumb">
                <a href="">首页</a>
	            <!--<a href="">演示</a>-->
                <a>
                    <cite>部门营业统计</cite>
                </a>
            </span>
	<a class="layui-btn layui-btn-small" style="line-height:1.6em;margin-top:3px;float:right" onclick="location.reload()" title="刷新">
		<i class="layui-icon layui-icon-refresh" style="line-height:30px"></i>
	</a>
</div>
<div class="layui-fluid">
	<div class="layui-row layui-col-space15">
		<div class="layui-col-md12" style="display:none">
			<div class="layui-card">
				<div class="layui-card-body ">
					<blockquote class="layui-elem-quote">欢迎您
						<span class="x-red"></span>！
						当前时间:
						<span id="timeSpan" class="x-red"></span>
					</blockquote>
				</div>
			</div>
		</div>
		<!--数据统计-->
		<div class="layui-col-md12">
			<div class="layui-card">
				<!--<div class="layui-card-header">查询条件</div>-->
				<div class="layui-card-body ">
					<form class="layui-form layui-col-space5">
						<div class="layui-inline layui-show-xs-block">
							<label for="bgDate"></label>
							<input class="layui-input" autocomplete="off" placeholder="开始日" name="bgDate" id="bgDate" th:value="${bgDate}">
						</div>
						<div class="layui-inline layui-show-xs-block">
							<label for="edDate"></label>
							<input class="layui-input" autocomplete="off" placeholder="截止日" name="edDate" id="edDate" th:value="${edDate}">
						</div>
						<div class="layui-inline layui-show-xs-block" style="display:none">
							<label>
								<input type="text" size="30" name="deptName" placeholder="请输入想要查询的部门(可不填)" autocomplete="off" class="layui-input">
							</label>
						</div>
						<div class="layui-inline layui-show-xs-block">
							<button class="layui-btn" lay-submit="" lay-filter="sreach">
								<i class="layui-icon">&#xe615;查询</i>
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>
		<!--部门营业明细-->
		<div class="layui-col-md12">
			<div class="layui-card">
				<!--<div class="layui-card-header">澡堂营业日统计</div>-->
				<!--				<div class="layui-card-body">-->
				<!--					<table class="layui-hide" id="zaotang" lay-filter="zaotang"></table>-->
				<!--					<script type="text/html" id="zaotang_bar">-->
				<!--						<span class="layui-badge layui-bg-black">澡堂营业日统计</span>-->
				<!--					</script>-->
				<!--				</div>-->
				<!--				<div class="layui-card-body">-->
				<!--					<table class="layui-hide" id="shitang" lay-filter="shitang"></table>-->
				<!--					<script type="text/html" id="shitang_bar">-->
				<!--						<span class="layui-badge layui-bg-black">餐厅营业日统计</span>-->
				<!--					</script>-->
				<!--				</div>-->
				<div class="layui-card-body" th:each="info,infoStat : ${deptDayTurnoverLists}">
					<div style="text-align:right">
						<button class="layui-btn" th:name="${info.jianpin}" lay-filter="export" onclick="printTable(this)">
							<i class="layui-icon">&#xe615;打印</i>
						</button>
					</div>
					<table class="layui-table" th:id="${info.jianpin}">
						<thead>
						<tr>
							<td colspan="2" style="text-align:center;font-family:'Britannic Bold',sans-serif;font-size:large" th:text="(${info.groupname})+资金消费汇总表"></td>
						</tr>
						<tr>
							<td>日期</td>
							<td>金额</td>
						</tr>
						</thead>
						<tbody>
						<tr th:each="i,it : ${info.listInfo}">
							<td th:text="${i.ADate}"></td>
							<td th:text="${i.AmountAllDay}"></td>
						</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
</div>
<script src="/x-admin/js/jquery-3.2.1.min.js" type="text/javascript"></script>
<!--<script src="/x-admin/lib/jquery/jquery-1.12.4.min.js" type="text/javascript"></script>-->
<script src="/x-admin/lib/layui/layui.js"></script>
<!--<script src="/x-admin/lib/layui/lay/modules/layer.js"></script>-->
<script src="/x-admin/lib/layui-ext-lib/excel.min.js"></script>
<script src="/x-admin/js/xadmin.js" type="text/javascript"></script>
<script src="/x-admin/js/date-formatter.js" type="text/javascript"></script>
<script src="/x-admin/lib/jquery/jQuery.print-1.6.0.js" type="text/javascript"></script>
<script type="text/javascript">
	layui.use('laydate',
		function(){
			const laydate = layui.laydate;
			//执行一个laydate实例
			laydate.render({
				//指定元素
				elem:'#bgDate',
				type:'datetime'
			});
			//执行一个laydate实例
			laydate.render({
				//指定元素
				elem:'#edDate',
				type:'datetime'
			});
		});
</script>
<script th:inline="javascript" type="text/javascript">
	$(function(){
		setInterval(function(){
			$('#timeSpan').text(getNowTime("yyyy-MM-dd HH:mm:ss"));
		},1000);
		// let data = [[${deptDayTurnoverJsonStr}]];
		// console.log(data);
		// getData();
	});
</script>
<script th:inline="javascript">
	let dataDept = [[${groupNameList}]];
	function getData(){
		console.log(dataDept);
		for(let t in dataDept){
			console.log(dataDept[t].groupname+'  '+dataDept[t].jianpin);
			renderZaoTangListData(dataDept[t].groupname,dataDept[t].jianpin);
		}
	}
	function renderZaoTangListData(deptName,eleId){
		console.log(deptName+'  '+eleId);
		layui.use('table',function(){
			let bgDate = $('#bgDate').val();
			let edDate = $('#edDate').val();
			const table = layui.table;
			table.render({
				elem:'#'+eleId,
				// url:'/welcomeListJson?bgDate='+bgDate+'&edDate='+edDate+'&deptName='+deptName,
				toolbar:'#'+eleId+'_bar',
				defaultToolbar:['filter','exports','print'],
			});
		});
	}
	function printTable(obj){
		let printId = obj.getAttribute('name');
		console.log('--------------');
		console.log(printId);
		console.log('--------------');
		// $("#myElementId").print({
		// 	globalStyles: true,
		// 	mediaPrint: false,
		// 	stylesheet: null,
		// 	noPrintSelector: ".no-print",
		// 	iframe: true,
		// 	append: null,
		// 	prepend: null,
		// 	manuallyCopyFormValues: true,
		// 	deferred: $.Deferred(),
		// 	timeout: 750,
		// 	title: null,
		// 	doctype: '<!doctype html>'
		// });
		$("#"+printId).print({
			title: null,
		});
	}
</script>
</body>
</html>
